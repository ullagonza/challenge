{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React, { Component } from 'react';\nimport LazyLoad from 'react-lazy-load';\nimport Header from '../components/Header';\nimport Link from 'next/link';\nimport { TweenLite } from 'gsap';\n\nvar Products =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Products, _Component);\n\n  function Products(props) {\n    var _this;\n\n    _classCallCheck(this, Products);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Products).call(this, props));\n    _this.redeem = _this.redeem.bind(_assertThisInitialized(_this));\n    _this.sortMostRecent = _this.sortMostRecent.bind(_assertThisInitialized(_this));\n    _this.sortLowestCost = _this.sortLowestCost.bind(_assertThisInitialized(_this));\n    _this.sortHighestCost = _this.sortHighestCost.bind(_assertThisInitialized(_this));\n    _this.state = {\n      buttonPressed1: false,\n      buttonPressed2: false,\n      buttonPressed3: false,\n      currentCost: 0,\n      isTop: true,\n      loading: true,\n      isLowestPrice: false,\n      isHigherPrice: false,\n      isProductsOriginal: false,\n      'products': []\n    };\n    return _this;\n  }\n\n  _createClass(Products, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var response, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch('https://coding-challenge-api.aerolab.co/products', {\n                  headers: new Headers({\n                    Authorization: \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDFkMmY4NzM2ZjEyNTAwNmZmOWIzZTAiLCJpYXQiOjE1NjIxOTM3OTl9.QaUDZ3qJA5FMwz0ThhGWoIxJ8pFpZv9I00XZM40PORc\"\n                  })\n                });\n\n              case 2:\n                response = _context.sent;\n                _context.next = 5;\n                return response.json();\n\n              case 5:\n                data = _context.sent;\n                this.setState({\n                  'products': data,\n                  loading: false\n                }); // Detect when scrolled through banner\n\n                document.addEventListener('scroll', function () {\n                  var isTop = window.scrollY < document.getElementById('banner').offsetHeight;\n\n                  if (isTop !== _this2.state.isTop) {\n                    _this2.setState({\n                      isTop: isTop\n                    });\n                  }\n                });\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"sortMostRecent\",\n    //Sort products from most recent creation date\n    value: function sortMostRecent() {\n      var products = this.state.products;\n      var newProducts = products;\n\n      if (!this.state.isLowestPrice) {\n        newProducts = products.sort(function (a, b) {\n          return a._id.localeCompare(b._id);\n        });\n      }\n\n      this.setState({\n        products: newProducts\n      });\n      this.setState({\n        buttonPressed1: true,\n        buttonPressed2: false,\n        buttonPressed3: false\n      }); //Scroll top\n\n      var element = document.getElementById(\"label\");\n      var headerOffset = 290;\n      var elementPosition = element.getBoundingClientRect().top;\n      var offsetPosition = elementPosition - headerOffset;\n      window.scrollTo({\n        top: offsetPosition,\n        behavior: \"smooth\"\n      });\n    }\n  }, {\n    key: \"sortLowestCost\",\n    //Sort products from lowest cost to highest\n    value: function sortLowestCost() {\n      var products = this.state.products;\n      var newProducts = products;\n\n      if (!this.state.isLowestPrice) {\n        newProducts = products.sort(function (a, b) {\n          return a.cost - b.cost;\n        });\n      }\n\n      this.setState({\n        products: newProducts\n      });\n      this.setState({\n        buttonPressed1: false,\n        buttonPressed2: true,\n        buttonPressed3: false\n      }); //Scroll top\n\n      var element = document.getElementById(\"label\");\n      var headerOffset = 290;\n      var elementPosition = element.getBoundingClientRect().top;\n      var offsetPosition = elementPosition - headerOffset;\n      window.scrollTo({\n        top: offsetPosition,\n        behavior: \"smooth\"\n      });\n    }\n  }, {\n    key: \"sortHighestCost\",\n    //Sort products from highest cost to lowest\n    value: function sortHighestCost() {\n      var products = this.state.products;\n      var newProducts = products;\n\n      if (!this.state.isLowestPrice) {\n        newProducts = products.sort(function (a, b) {\n          return b.cost - a.cost;\n        });\n      }\n\n      this.setState({\n        products: newProducts\n      });\n      this.setState({\n        buttonPressed1: false,\n        buttonPressed2: false,\n        buttonPressed3: true\n      }); //Scroll top\n\n      var element = document.getElementById(\"label\");\n      var headerOffset = 290;\n      var elementPosition = element.getBoundingClientRect().top;\n      var offsetPosition = elementPosition - headerOffset;\n      window.scrollTo({\n        top: offsetPosition,\n        behavior: \"smooth\"\n      });\n    }\n  }, {\n    key: \"showLabel\",\n    //revealLabel\n    value: function showLabel(product, cost) {\n      document.getElementById(\"product\").innerHTML = product;\n      document.getElementById(\"cost\").innerHTML = cost;\n      document.getElementById('label').classList.add('label--show'); //Updates current product cost\n\n      this.setState({\n        currentCost: cost\n      });\n    }\n  }, {\n    key: \"removeLabel\",\n    //RemoveLabel\n    value: function removeLabel() {\n      document.getElementById('label').classList.remove('label--show');\n    }\n  }, {\n    key: \"redeem\",\n    value: function redeem() {\n      if (this.props.points - this.state.currentCost >= 0) {\n        document.getElementById('label').classList.add('label--show');\n        this.removeLabel(); //Apply countdown in GSAP\n\n        var Cont = {\n          val: this.props.points\n        },\n            NewVal = this.props.points - this.state.currentCost;\n        TweenLite.to(Cont, 2, {\n          val: NewVal,\n          roundProps: \"val\",\n          onUpdate: function onUpdate() {\n            document.getElementById(\"counter\").innerHTML = Cont.val;\n          }\n        });\n        TweenLite.to('#counterContainer', 2, {\n          background: \"linear-gradient(#25BBF1, #0AD4FA)\",\n          ease: Power3.easeIn\n        });\n        TweenLite.to('#counter', 0, {\n          color: \"#fff\",\n          ease: Power3.easeIn\n        });\n        TweenLite.to('#counterContainer', 2, {\n          delay: 2,\n          background: \"#EDEDED\",\n          ease: Power3.easeIn\n        });\n        TweenLite.to('#counter', 0, {\n          delay: 2,\n          color: \"#616161\",\n          ease: Power3.easeIn\n        });\n        this.props.action(this.props.points - this.state.currentCost);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      //Redeem\n      var points = this.props.points;\n      return React.createElement(\"div\", null, React.createElement(\"div\", {\n        id: \"label\",\n        className: \"label\"\n      }, React.createElement(\"div\", {\n        className: \"label__left\"\n      }, React.createElement(\"div\", {\n        className: \"label__left__text\"\n      }, \"You are about to redeem \", React.createElement(\"span\", {\n        id: \"product\"\n      }), \" for \", React.createElement(\"span\", {\n        id: \"cost\"\n      })), React.createElement(\"div\", {\n        className: \"label__left__image\"\n      }, React.createElement(\"img\", {\n        src: \"../static/img/coin.svg\"\n      }))), React.createElement(\"div\", {\n        className: \"label__right\"\n      }, React.createElement(\"div\", {\n        onClick: this.removeLabel,\n        className: \"label__right__cancel\"\n      }, \"Cancel\"), React.createElement(\"div\", {\n        onClick: this.redeem,\n        className: \"label__right__redeem\"\n      }, \"Redeem now\"))), React.createElement(\"div\", {\n        className: \"outer-sortbar\" + ' ' + \"outer-sortbar--\" + (this.state.isTop ? 'normal' : 'fixed')\n      }, React.createElement(\"div\", {\n        className: \"sortbar\"\n      }, React.createElement(\"div\", {\n        className: \"sortbar__title\"\n      }, \"Sort by:\"), React.createElement(\"div\", {\n        className: \"sortbar__buttons\"\n      }, React.createElement(\"div\", {\n        onClick: this.sortMostRecent,\n        className: this.state.buttonPressed1 ? \"sortbar__buttons__button sortbar__buttons__button--isactive\" : \"sortbar__buttons__button\"\n      }, \"Most recent\"), React.createElement(\"div\", {\n        onClick: this.sortLowestCost,\n        className: this.state.buttonPressed2 ? \"sortbar__buttons__button sortbar__buttons__button--isactive\" : \"sortbar__buttons__button\"\n      }, \"Lowest price\"), React.createElement(\"div\", {\n        onClick: this.sortHighestCost,\n        className: this.state.buttonPressed3 ? \"sortbar__buttons__button sortbar__buttons__button--isactive\" : \"sortbar__buttons__button\"\n      }, \"Highest price\")))), React.createElement(\"div\", {\n        className: \"grid\"\n      }, this.state.products.map(function (item, index) {\n        var _this3 = this;\n\n        if (item.cost <= points) {\n          return React.createElement(LazyLoad, null, React.createElement(\"div\", {\n            className: \"grid__item\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__overlay\"\n          }, React.createElement(\"svg\", {\n            width: \"42px\",\n            height: \"42px\",\n            viewBox: \"0 0 42 42\",\n            version: \"1.1\"\n          }, React.createElement(\"defs\", null, React.createElement(\"radialGradient\", {\n            cx: \"50%\",\n            cy: \"50.8764901%\",\n            fx: \"50%\",\n            fy: \"50.8764901%\",\n            r: \"79.8469947%\",\n            id: \"radialGradient-1\"\n          }, React.createElement(\"stop\", {\n            \"stop-color\": \"#0AD4FA\",\n            offset: \"0%\"\n          }), React.createElement(\"stop\", {\n            \"stop-color\": \"#25BBF1\",\n            offset: \"100%\"\n          }))), React.createElement(\"g\", {\n            id: \"Catalog\",\n            stroke: \"none\",\n            \"stroke-width\": \"1\",\n            fill: \"none\",\n            \"fill-rule\": \"evenodd\"\n          }, React.createElement(\"g\", {\n            id: \"Page-1\",\n            transform: \"translate(-354.000000, -684.000000)\"\n          }, React.createElement(\"g\", {\n            id: \"products\",\n            transform: \"translate(132.000000, 660.000000)\"\n          }, React.createElement(\"g\", {\n            id: \"line-1\"\n          }, React.createElement(\"g\", {\n            id: \"product-card\",\n            transform: \"translate(0.000000, 12.000000)\"\n          }, React.createElement(\"g\", {\n            id: \"icon\",\n            transform: \"translate(222.000000, 12.000000)\"\n          }, React.createElement(\"circle\", {\n            id: \"circle\",\n            fill: \"url(#radialGradient-1)\",\n            cx: \"21\",\n            cy: \"21\",\n            r: \"21\"\n          }), React.createElement(\"path\", {\n            d: \"M29.9946924,29.1076172 L28.8822001,15.5306936 C28.8580225,15.225303 28.594495,14.9894436 28.277518,14.9894436 L25.2452125,14.9894436 L25.2452125,13.9296875 C25.2452125,12.3142578 23.8849203,11 22.2129071,11 L19.7870627,11 C18.1150494,11 16.7547572,12.3142578 16.7547572,13.9296875 L16.7547572,14.9894436 L13.7224518,14.9894436 C13.4054748,14.9894436 13.1419472,15.225303 13.1177696,15.5306936 L12.0053178,29.1073828 C11.9665447,29.5939844 12.1411651,30.0784375 12.4843816,30.4365234 C12.8275982,30.7946094 13.3141821,31 13.8193238,31 L28.1806055,31 C28.6857472,31 29.1722907,30.7946484 29.5155477,30.4365625 C29.8588046,30.0784766 30.033425,29.5940234 29.9946924,29.1076172 Z M18,14.25 C18,13.00935 18.80748,12 19.8,12 L22.2,12 C23.19252,12 24,13.00935 24,14.25 L24,15 L18,15 L18,14.25 Z\",\n            id: \"bag\",\n            fill: \"#FFFFFF\",\n            \"fill-rule\": \"nonzero\"\n          })))))))), React.createElement(\"div\", {\n            className: \"grid__item__overlay__cost\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__overlay__cost__number\"\n          }, item.cost), React.createElement(\"div\", {\n            className: \"grid__item__overlay__cost__coin\"\n          }, React.createElement(\"img\", {\n            src: \"../static/img/coin.svg\",\n            onLoad: function onLoad() {\n              return _this3.setState({\n                loaded: true\n              });\n            }\n          }))), React.createElement(\"div\", {\n            onClick: function onClick() {\n              _this3.showLabel(item.name, item.cost);\n            },\n            className: \"grid__item__overlay__button\"\n          }, \"Redeem prize\")), React.createElement(\"div\", {\n            className: \"grid__item__image\"\n          }, React.createElement(\"img\", {\n            src: item.img.url\n          })), React.createElement(\"div\", {\n            className: \"grid__item__data\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__data__cat\"\n          }, item.category), React.createElement(\"div\", {\n            className: \"grid__item__data__name\"\n          }, item.name))));\n        } else {\n          return React.createElement(\"div\", {\n            className: \"grid__item grid__item--unaffordable\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__overlay\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__overlay__info\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__overlay__info__text\"\n          }, \"You need \", -(points - item.cost)), React.createElement(\"div\", {\n            className: \"grid__item__overlay__info__coin\"\n          }, React.createElement(\"img\", {\n            src: \"../static/img/coin.svg\"\n          })))), React.createElement(\"div\", {\n            className: \"grid__item__image\"\n          }, React.createElement(\"img\", {\n            src: item.img.url\n          })), React.createElement(\"div\", {\n            className: \"grid__item__data\"\n          }, React.createElement(\"div\", {\n            className: \"grid__item__data__cat\"\n          }, item.category), React.createElement(\"div\", {\n            className: \"grid__item__data__name\"\n          }, item.name)));\n        }\n      }, this)), React.createElement(\"p\", {\n        className: \"grid__message\"\n      }, \"Showing \", React.createElement(\"span\", null, this.state.products.length), \" awesome products\"));\n    }\n  }]);\n\n  return Products;\n}(Component);\n\nexport default Products;","map":null,"metadata":{},"sourceType":"module"}